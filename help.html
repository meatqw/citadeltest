<style>
  #allrecords .doc-help__text {
    color: #000000;
    text-decoration: none;
  }
  .t-records .doc-help__text {
    color: #000000;
    text-decoration: none;
  }

  .title {
    font-weight: 900;
  }

  .link:hover {
    text-decoration: underline;
  }

  input {
    outline: none;
  }

  .popup {
    font-family: "Montserrat";
  }

  .popup-help {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
    background: #fff;
    padding: 35px 0;
    border-radius: 40px;
    box-shadow: 0px 0px 3px 1px #eeb4c8;
  }

  .popup-help__title {
    font-weight: 700;
    font-size: 40px;
    line-height: 119.9%;
    text-align: center;
    color: #dc7b9d;
    padding-bottom: 15px;
  }

  .popup-help__subtitle {
    font-weight: 200;
    font-size: 16px;
    line-height: 119.9%;
    text-align: center;
    color: #000000;
  }

  .popup-help__content {
    display: flex;
    gap: 50px;
    padding: 40px 30px;
  }

  .popup-help__form {
    display: flex;
    flex-direction: column;
    gap: 25px;
  }

  .popup-help__form input {
    border: none;
    border-bottom: 2px solid #dc7b9d;
    width: 100%;
    max-width: 249px;
    height: 27px;
    font-family: "Montserrat";
    font-size: 16px;
    font-weight: 200;
  }

  .popup-help__form input::placeholder {
    font-size: 16px;
  }

  .popup-help__documents {
    max-width: 370px;
    display: flex;
    flex-direction: column;
    gap: 20px;
  }

  .doc-help {
  }

  .doc-help__title {
    font-weight: 500;
    font-size: 16px;
    line-height: 119.9%;
    color: #000000;
  }

  .doc-help__content {
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  .doc-help__item {
    display: flex;
    gap: 10px;
    align-items: center;
    font-weight: 200;
    font-size: 14px;
    line-height: 119.9%;
    text-decoration-line: underline;
    color: #4b4b4b;
  }

  .doc-help__img img {
    max-width: 30px;
  }

  .doc-help__text {
  }

  .popup-help__footer {
  }

  .popup-help__button {
    font-weight: 600;
    font-size: 16px;
    line-height: 119.9%;
    color: #ffffff;
    padding: 13px 50px;
    filter: drop-shadow(0px 2px 4px #dc7b9d);
    background: linear-gradient(
      270deg,
      rgba(194, 54, 104, 0.52) 0%,
      #ad778a 100%
    );
    border-radius: 25px;
  }

  .button {
    border: none;
    cursor: pointer;
  }

  .button:hover {
    background: #fff;
    outline: 1px solid #8f284c;
    color: #8f284c;
  }

  /* download button */
  .input__wrapper {
    width: 100%;
    position: relative;
    text-align: center;
  }

  .input__file {
    opacity: 0;
    visibility: hidden;
    position: absolute;
  }

  .input__file-icon-wrapper {
    height: 40px;
    width: 40px;
    margin-right: 1px;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
    -ms-flex-align: center;
    align-items: center;
    -webkit-box-pack: center;
    -ms-flex-pack: center;
    justify-content: center;
  }

  .input__file-button-text {
    line-height: 1;
    margin-top: 1px;
  }

  .input__file-button {
    width: 100%;
    max-width: 249px;
    height: 45px;
    background: #fff;
    color: #000000;
    font-size: 14px;
    font-weight: 200;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
    -ms-flex-align: center;
    align-items: center;
    -webkit-box-pack: start;
    -ms-flex-pack: start;
    justify-content: flex-start;
    border-radius: 15px;
    cursor: pointer;
    border: 2px solid #dc7b9d;
  }

  /* popup */
  body.lock {
    overflow: hidden;
  }

  .popup {
    position: fixed;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.8);
    top: 0;
    left: 0;
    opacity: 0;
    visibility: hidden;
    overflow-y: auto;
    overflow-x: hidden;
    transition: all 0.5s ease 0s;
    z-index: 10000;
  }

  .popup.open {
    opacity: 1;
    visibility: visible;
  }

  .popup__body {
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 30px 10px;
  }

  .popup__content {
    position: relative;
    color: #000;
    max-width: 800px;
  }

  .popup__close {
    position: absolute;
    right: 10px;
    top: 10px;
  }

  @media (max-width: 959px) {
    .popup-help {
      padding: 25px 0;
    }

    .popup-help__title {
      font-size: 32px;
      padding-bottom: 10px;
    }

    .popup-help__content {
      gap: 35px;
      padding: 25px 30px;
    }

    .popup-help__form {
      gap: 20px;
    }

    .popup-help__form input {
      font-size: 14px;
    }

    .popup-help__form input::placeholder {
      font-size: 14px;
    }

    .popup-help__documents {
      max-width: 290px;
      gap: 10px;
    }

    .doc-help__title {
      font-size: 14px;
    }

    .doc-help__item {
      font-size: 12px;
    }

    .doc-help__img img {
      max-width: 25px;
    }

    .input__file-icon-wrapper {
      height: 40px;
      width: 40px;
      margin-right: 1px;
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-align: center;
      -ms-flex-align: center;
      align-items: center;
      -webkit-box-pack: center;
      -ms-flex-pack: center;
      justify-content: center;
    }

    .input__file-button-text {
      line-height: 1;
      margin-top: 1px;
    }

    .input__file-button {
      width: 100%;
      max-width: 249px;
      height: 45px;
      background: #fff;
      color: #000000;
      font-size: 14px;
      font-weight: 200;
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-align: center;
      -ms-flex-align: center;
      align-items: center;
      -webkit-box-pack: start;
      -ms-flex-pack: start;
      justify-content: flex-start;
      border-radius: 15px;
      cursor: pointer;
      border: 2px solid #dc7b9d;
    }
  }

  @media (max-width: 600px) {
    .popup-help {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      width: 100%;
      height: 100%;
      background: #fff;
      border-radius: 20px;
      padding: 25px 0;
    }

    .popup-help__title {
      font-size: 20px;
      padding-bottom: 15px;
    }

    .popup-help__subtitle {
      font-size: 14px;
    }

    .popup-help__content {
      display: flex;
      flex-direction: column;
      gap: 15px;
      padding: 15px 20px;
    }

    .popup-help__form {
      display: flex;
      flex-direction: column;
      gap: 25px;
    }

    .popup-help__form input {
      max-width: 100%;
      font-size: 14px;
    }

    .popup-help__form input::placeholder {
      font-size: 14px;
    }

    .popup-help__documents {
      max-width: 100%;
      gap: 10px;
    }

    .doc-help__title {
      font-size: 14px;
    }

    .doc-help__content {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .doc-help__item {
      display: flex;
      gap: 10px;
      align-items: center;
      font-weight: 200;
      font-size: 12px;
      line-height: 119.9%;
      text-decoration-line: underline;
      color: #4b4b4b;
    }

    .doc-help__img img {
      max-width: 30px;
    }

    .doc-help__text {
    }

    .popup-help__footer {
    }

    .popup-help__button {
      font-weight: 600;
      font-size: 16px;
      line-height: 119.9%;
      color: #ffffff;
      padding: 13px 50px;
      filter: drop-shadow(0px 2px 4px #dc7b9d);
      background: linear-gradient(
        270deg,
        rgba(194, 54, 104, 0.52) 0%,
        #ad778a 100%
      );
      border-radius: 25px;
    }

    .button {
    }

    .button:hover {
      background: #fff;
      outline: 1px solid #8f284c;
      color: #8f284c;
    }

    /* download button */
    .input__wrapper {
      width: 100%;
      position: relative;
      text-align: center;
    }

    .input__file {
      opacity: 0;
      visibility: hidden;
      position: absolute;
    }

    .input__file-icon-wrapper {
      height: 40px;
      width: 40px;
      margin-right: 1px;
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-align: center;
      -ms-flex-align: center;
      align-items: center;
      -webkit-box-pack: center;
      -ms-flex-pack: center;
      justify-content: center;
    }

    .input__file-button-text {
      line-height: 1;
      margin-top: 1px;
    }

    .input__file-button {
      width: 100%;
      max-width: 249px;
      height: 45px;
      background: #fff;
      color: #000000;
      font-size: 14px;
      font-weight: 200;
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-align: center;
      -ms-flex-align: center;
      align-items: center;
      -webkit-box-pack: start;
      -ms-flex-pack: start;
      justify-content: flex-start;
      border-radius: 15px;
      cursor: pointer;
      border: 2px solid #dc7b9d;
    }
  }
</style>

<div id="popup_help" class="popup">
  <div class="popup__body">
    <div class="popup__content">
      <!-- <a href="#" class="popup__close close-popup">&times;</a> -->
      <div class="popup-help">
        <h3 class="popup-help__title">Получить помощь</h3>
        <div class="popup-help__subtitle">
          Заполните все необходимые данные:
        </div>
        <div class="popup-help__content">
          <form action="" class="popup-help__form">
            <input
              type="text"
              class="input"
              id="fullname"
              name="fullname"
              placeholder="Введите ФИО"
              required
            />
            <input
              type="email"
              class="input"
              id="email"
              name="email"
              placeholder="Введите почту"
              required
            />
            <input
              type="tel"
              class="input"
              id="phone"
              name="phone"
              placeholder="Введите телефон"
              required
            />
            <div class="input__wrapper">
              <input
                name="file"
                type="file"
                name="file"
                id="input__file"
                class="input input__file"
                multiple
              />
              <label for="input__file" class="input__file-button">
                <span class="input__file-icon-wrapper"
                  ><img
                    class="input__file-icon"
                    src="https://static.tildacdn.com/tild3762-3364-4761-b434-306166616363/arrow_download.svg"
                    alt="Выбрать файл"
                    width="25"
                /></span>
                <span class="input__file-button-text">Выберите файлы</span>
              </label>
            </div>
          </form>
          <div class="popup-help__documents doc-help">
            <div class="doc-help__title">Перечень необходимых документов:</div>
            <div class="doc-help__content">
              <a href="#" class="doc-help__item">
                <div class="doc-help__img">
                  <img
                    src="https://static.tildacdn.com/tild3932-3230-4238-b265-643939663635/icon_svg_1.svg"
                    alt="pdf"
                  />
                </div>
                <div class="doc-help__text">Паспорт заявителя</div>
              </a>
              <a href="#" class="doc-help__item">
                <div class="doc-help__img">
                  <img
                    src="https://static.tildacdn.com/tild3932-3230-4238-b265-643939663635/icon_svg_1.svg"
                    alt="pdf"
                  />
                </div>
                <div class="doc-help__text">
                  Медицинские и иные документы подтверждающие необходимость
                  помощи
                </div>
              </a>
              <a href="#" class="doc-help__item">
                <div class="doc-help__img">
                  <img
                    src="https://static.tildacdn.com/tild3932-3230-4238-b265-643939663635/icon_svg_1.svg"
                    alt="pdf"
                  />
                </div>
                <div class="doc-help__text">
                  Справка об инвалидности (при наличии)
                </div>
              </a>
              <a href="#" class="doc-help__item">
                <div class="doc-help__img">
                  <img
                    src="https://static.tildacdn.com/tild3932-3230-4238-b265-643939663635/icon_svg_1.svg"
                    alt="pdf"
                  />
                </div>
                <div class="doc-help__text">
                  Справка из соцзащиты (при наличии)
                </div>
              </a>
              <a href="#" class="doc-help__item">
                <div class="doc-help__img">
                  <img
                    src="https://static.tildacdn.com/tild3932-3230-4238-b265-643939663635/icon_svg_1.svg"
                    alt="pdf"
                  />
                </div>
                <div class="doc-help__text">
                  Обращение заявителя на имя Президента фонда с просьбой о
                  помощи
                </div>
              </a>
            </div>
          </div>
        </div>
        <div class="popup-help__footer">
          <button class="popup-help__button button">Отправить</button>
        </div>
      </div>
    </div>
  </div>
</div>
<script>
  const btn = document.querySelector("button");
  btn.addEventListener("click", async function () {
    let fullname = document.getElementById("fullname").value;
    let email = document.getElementById("email").value;
    let phone = document.getElementById("phone").value;

    if (fullname.length != 0 && email.length != 0 && phone.length != 0) {
      var file = [];
      let files = document.getElementById("input__file").files;
      console.log(files);
      var url = "http://37.46.129.236/api/upload";
      for (var i = 0; i < files.length; i++) {
        const formData = new FormData();
        formData.append("img", files[i]);
        const response = await fetch(url, {
          method: "POST",
          body: formData,
        });
        file.push(await response.text());
      }

      var urlApi = "http://37.46.129.236/api/help";
      let data = {
        fullname: fullname,
        email: email,
        phone: phone,
        documents: { docs: file },
      };

      const response = fetch(urlApi, {
        headers: {
          "Content-Type": "application/json;charset=utf-8",
        },
        method: "POST",
        body: JSON.stringify(data),
      });
    }
  });
</script>

<script>
  const popupLinks = document.querySelectorAll(".popup-link");
  const body = document.querySelector("body");
  const lockPadding = document.querySelectorAll(".lock-padding");

  let unlock = true;

  const timeout = 500;

  if (popupLinks.length > 0) {
    for (let index = 0; index < popupLinks.length; index++) {
      const popupLink = popupLinks[index];
      popupLink.addEventListener("click", function (e) {
        const popupName = popupLink.getAttribute("href").replace("#", "");
        const curentPopup = document.getElementById(popupName);
        popupOpen(curentPopup);
        e.prevetnDefault();
      });
    }
  }

  const popupCloseIcon = document.querySelectorAll(".close-popup");
  if (popupCloseIcon.length > 0) {
    for (let index = 0; index < popupCloseIcon.length; index++) {
      const el = popupCloseIcon[index];
      el.addEventListener("click", function (e) {
        popupClose(el.closest(".popup"));
        e.preventDefault();
      });
    }
  }

  function popupOpen(curentPopup) {
    if (curentPopup && unlock) {
      const popupActive = document.querySelector(".popup.open");
      if (popupActive) {
        popupClose(popupActive, false);
      } else {
        bodyLock();
      }
      curentPopup.classList.add("open");
      curentPopup.addEventListener("click", function (e) {
        if (!e.target.closest(".popup__content")) {
          popupClose(e.target.closest(".popup"));
        }
      });
    }
  }
  function popupClose(popupActive, doUnlock = true) {
    if (unlock) {
      popupActive.classList.remove("open");
      if (doUnlock) {
        bodyUnLock();
      }
    }
  }

  function bodyLock() {
    const lockPaddingValue =
      window.innerWidth - document.querySelector("body").offsetWidth + "px";

    if (lockPadding.length > 0) {
      for (let index = 0; index < lockPadding.length; index++) {
        const el = lockPadding[index];
        el.getElementsByClassName.paddingRight = lockPaddingValue;
      }
    }
    body.style.paddingRight = lockPaddingValue;
    body.classList.add("lock");

    unlock = false;
    setTimeout(function () {
      unlock = true;
    }, timeout);
  }

  function bodyUnLock() {
    setTimeout(function () {
      if (lockPadding.length > 0) {
        for (let index = 0; index < lockPadding.length; index++) {
          const el = lockPadding[index];
          el.style.paddingRight = "0px";
        }
      }
      body.style.paddingRight = "0px";
      body.classList.remove("lock");
    }, timeout);

    unlock = false;
    setTimeout(function () {
      unlock = true;
    }, timeout);
  }

  document.addEventListener("keydown", function (e) {
    if (e.which === 27) {
      const popupActive = document.querySelector(".popup.open");
      popupClose(popupActive);
    }
  });

  (function () {
    // проверяем поддержку
    if (!Element.prototype.closest) {
      // реализуем
      Element.prototype.closest = function (css) {
        var node = this;
        while (node) {
          if (node.matches(css)) return node;
          else node = node.parentElement;
        }
        return null;
      };
    }
  })();
  (function () {
    // проверяем поддержку
    if (!Element.prototype.matches) {
      // определяем свойство
      Element.prototype.matches =
        Element.prototype.matchesSelector ||
        Element.prototype.webkitMatchesSelector ||
        Element.prototype.mozMatchesSelector ||
        Element.prototype.msMatchesSelector;
    }
  })();
</script>
<script>
  let inputs = document.querySelectorAll(".input__file");
  Array.prototype.forEach.call(inputs, function (input) {
    let label = input.nextElementSibling,
      labelVal = label.querySelector(".input__file-button-text").innerText;

    input.addEventListener("change", function (e) {
      let countFiles = "";
      if (this.files && this.files.length >= 1) countFiles = this.files.length;

      if (countFiles)
        label.querySelector(".input__file-button-text").innerText =
          "Выбрано файлов: " + countFiles;
      else label.querySelector(".input__file-button-text").innerText = labelVal;
    });
  });
</script>
